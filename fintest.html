<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å€‹äººè²¡å‹™åˆ†ææ¸¬é©—</title>
    <meta name="description" content="å¿«é€Ÿè©•ä¼°æ‚¨çš„é‡‘èçŸ¥è­˜èˆ‡æŠ•è³‡å±¬æ€§ï¼Œç²å¾—å°ˆå±¬ç†è²¡å»ºè­°ã€‚">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            font-family: 'Noto Sans TC', sans-serif;
            background: linear-gradient(120deg, #e6f7ff, #e6ffed);
            min-height: 100vh;
            overflow-x: hidden;
        }
        .floating { position: absolute; animation: float 8s infinite ease-in-out; opacity: 0.12; z-index: -1; }
        @keyframes float { 0% {transform:translate(0,0) rotate(0deg);} 50% {transform:translate(0,-25px) rotate(3deg);} 100% {transform:translate(0,0) rotate(0deg);} }
        .btn-option { transition: all 0.3s; }
        .btn-option.selected, .btn-option:focus { border-color: #14b8a6; background: #f0fdfa; }
        .progress-bar { transition: width 0.5s; }
        .trait-badge { display:inline-block; padding:0.25rem 0.75rem; border-radius:9999px; font-size:0.875rem; font-weight:500; margin:0.25rem; }
        .tool-tag { display:inline-block; padding:0.15rem 0.5rem; border-radius:9999px; font-size:0.75rem; margin:0.15rem; background-color:rgba(49,151,149,0.1); color:#2c7a7b; border:1px solid rgba(49,151,149,0.2); }
        .recommendation-card { transition: all 0.3s; }
        .recommendation-card:hover { transform: translateY(-5px); box-shadow: 0 10px 25px rgba(0,0,0,0.1); }
    </style>
</head>
<body>
    <div id="floating-elements"></div>
    <main class="container mx-auto px-4 py-8 max-w-3xl relative z-10">
        <section class="text-center mb-8">
            <h1 class="text-3xl font-bold text-teal-700 mb-2">å€‹äººè²¡å‹™åˆ†ææ¸¬é©— ğŸ’°</h1>
            <p class="text-lg text-teal-600">æ¸¬è©¦æ‚¨å°é‡‘èæ¦‚å¿µçš„äº†è§£ç¨‹åº¦</p>
        </section>
        <div class="mb-6 bg-white rounded-full h-4 shadow-inner overflow-hidden">
            <div id="progress-bar" class="progress-bar h-full bg-gradient-to-r from-teal-400 to-blue-500 rounded-full" style="width:0%"></div>
        </div>
        <section id="quiz-container" class="bg-white rounded-xl shadow-lg p-6 mb-8">
            <form id="user-info-form" class="space-y-4">
                <div>
                    <label for="name" class="block text-sm font-medium text-gray-700 mb-1">å§“å</label>
                    <input type="text" id="name" name="name" required autocomplete="name" class="form-input w-full px-4 py-2 rounded-lg bg-gray-50 border border-gray-200 focus:outline-none">
                </div>
                <div>
                    <label for="age" class="block text-sm font-medium text-gray-700 mb-1">å¹´é½¡</label>
                    <input type="number" id="age" name="age" min="18" max="120" required autocomplete="age" class="form-input w-full px-4 py-2 rounded-lg bg-gray-50 border border-gray-200 focus:outline-none">
                </div>
                <div>
                    <label for="occupation" class="block text-sm font-medium text-gray-700 mb-1">è·æ¥­</label>
                    <input type="text" id="occupation" name="occupation" required autocomplete="organization-title" class="form-input w-full px-4 py-2 rounded-lg bg-gray-50 border border-gray-200 focus:outline-none">
                </div>
                <div>
                    <label for="email" class="block text-sm font-medium text-gray-700 mb-1">EMAIL</label>
                    <input type="text" id="email" name="email" required autocomplete="organization-title" class="form-input w-full px-4 py-2 rounded-lg bg-gray-50 border border-gray-200 focus:outline-none">
                </div>                
                <div>
                    <label for="region" class="block text-sm font-medium text-gray-700 mb-1">å±…ä½åœ°å€</label>
                    <select id="region" name="region" required class="form-input w-full px-4 py-2 rounded-lg bg-gray-50 border border-gray-200 focus:outline-none">
                        <option value="" disabled selected>è«‹é¸æ“‡æ‚¨çš„å±…ä½åœ°å€</option>
                        <option value="å°åŒ—å¸‚">å°åŒ—å¸‚</option>
                        <option value="æ–°åŒ—å¸‚">æ–°åŒ—å¸‚</option>
                        <option value="æ¡ƒåœ’å¸‚">æ¡ƒåœ’å¸‚</option>
                        <option value="å°ä¸­å¸‚">å°ä¸­å¸‚</option>
                        <option value="å°å—å¸‚">å°å—å¸‚</option>
                        <option value="é«˜é›„å¸‚">é«˜é›„å¸‚</option>
                        <option value="åŸºéš†å¸‚">åŸºéš†å¸‚</option>
                        <option value="æ–°ç«¹å¸‚">æ–°ç«¹å¸‚</option>
                        <option value="æ–°ç«¹ç¸£">æ–°ç«¹ç¸£</option>
                        <option value="è‹—æ —ç¸£">è‹—æ —ç¸£</option>
                        <option value="å½°åŒ–ç¸£">å½°åŒ–ç¸£</option>
                        <option value="å—æŠ•ç¸£">å—æŠ•ç¸£</option>
                        <option value="é›²æ—ç¸£">é›²æ—ç¸£</option>
                        <option value="å˜‰ç¾©å¸‚">å˜‰ç¾©å¸‚</option>
                        <option value="å˜‰ç¾©ç¸£">å˜‰ç¾©ç¸£</option>
                        <option value="å±æ±ç¸£">å±æ±ç¸£</option>
                        <option value="å®œè˜­ç¸£">å®œè˜­ç¸£</option>
                        <option value="èŠ±è“®ç¸£">èŠ±è“®ç¸£</option>
                        <option value="å°æ±ç¸£">å°æ±ç¸£</option>
                        <option value="æ¾æ¹–ç¸£">æ¾æ¹–ç¸£</option>
                        <option value="é‡‘é–€ç¸£">é‡‘é–€ç¸£</option>
                        <option value="é€£æ±Ÿç¸£">é€£æ±Ÿç¸£</option>
                        <option value="æµ·å¤–">æµ·å¤–</option>
                    </select>
                </div>
                <button id="start-btn" type="submit" class="w-full bg-gradient-to-r from-teal-500 to-blue-500 text-white font-medium py-3 px-8 rounded-full mt-4">é–‹å§‹æ¸¬é©— â–¶ï¸</button>
            </form>
            <div id="question-screen" class="hidden">
                <div class="mb-1 flex justify-between items-center">
                    <span id="question-number" class="text-sm font-medium text-teal-600"></span>
                </div>
                <h3 id="question-text" class="text-xl font-bold text-teal-800 mb-4"></h3>
                <div id="options-container" class="space-y-3 mb-6"></div>
                <div class="flex justify-between">
                    <button id="prev-btn" class="hidden bg-gray-200 text-gray-700 py-2 px-4 rounded-lg">â—€ï¸ ä¸Šä¸€é¡Œ</button>
                    <button id="next-btn" class="bg-teal-600 text-white py-2 px-6 rounded-lg ml-auto" disabled>ä¸‹ä¸€é¡Œ â–¶ï¸</button>
                </div>
            </div>
            <div id="result-screen" class="hidden"></div>
        </section>
    </main>
    <script>
        // ==== Google Apps Script Web App URL ====
        const GOOGLE_SCRIPT_URL = "https://script.google.com/macros/s/AKfycbx_NznoPG6qNfctVXlXM0MntgCNClKBmpR6DopBztgw8eoMxwQEAs0c1RnLMpoNJolQpw/exec";
        // ==== é¡Œç›®å’Œç­‰ç´šå®šç¾© ====
        const questions = [
            {question: "æ‚¨æœ‰å¤šå°‘å¹´çš„æŠ•è³‡ç¶“é©—ï¼Ÿ ğŸ“ˆ", options: [
                { text: "A. 5å¹´ä»¥ä¸Š", score: 4 },
                { text: "B. 3-5å¹´", score: 3 },
                { text: "C. 1-3å¹´", score: 2 },
                { text: "D. ä¸åˆ°1å¹´æˆ–ç„¡ç¶“é©—", score: 1 }
            ], category: "experience" },
            {question: "æ‚¨ä½¿ç”¨éå“ªäº›æŠ•è³‡å·¥å…·ï¼Ÿ ğŸ§°", options: [
                { text: "A. è‚¡ç¥¨ã€å‚µåˆ¸ã€åŸºé‡‘ã€æœŸè²¨/é¸æ“‡æ¬Šç­‰å¤šç¨®å·¥å…·", score: 4 },
                { text: "B. è‚¡ç¥¨ã€å‚µåˆ¸å’ŒåŸºé‡‘", score: 3 },
                { text: "C. ä¸»è¦æ˜¯åŸºé‡‘æˆ–ETF", score: 2 },
                { text: "D. åªæœ‰å®šå­˜æˆ–ä¿éšª", score: 1 }
            ], category: "knowledge" },
            {question: "ç•¶å¸‚å ´ä¸‹è·Œæ™‚ï¼Œæ‚¨é€šå¸¸æœƒå¦‚ä½•åæ‡‰ï¼Ÿ ğŸ“‰", options: [
                { text: "A. è¦–ç‚ºè²·å…¥æ©Ÿæœƒï¼Œå¢åŠ æŠ•è³‡", score: 4 },
                { text: "B. ä¿æŒå†·éœï¼Œå …æŒåŸæœ‰ç­–ç•¥", score: 3 },
                { text: "C. æœ‰äº›æ“”æ†‚ï¼Œä½†ä¸æœƒç«‹å³è¡Œå‹•", score: 2 },
                { text: "D. éå¸¸æ“”å¿ƒï¼Œè€ƒæ…®è³£å‡ºæ­¢æ", score: 1 }
            ], category: "risk_tolerance" },
            {question: "æ‚¨å°è‡ªå·±çš„è²¡å‹™çŸ¥è­˜è©•åƒ¹å¦‚ä½•ï¼Ÿ ğŸ“š", options: [
                { text: "A. éå¸¸äº†è§£å„ç¨®é‡‘èç”¢å“å’Œå¸‚å ´é‹ä½œ", score: 4 },
                { text: "B. äº†è§£åŸºæœ¬çš„æŠ•è³‡æ¦‚å¿µå’Œç­–ç•¥", score: 3 },
                { text: "C. æœ‰ä¸€äº›åŸºç¤çŸ¥è­˜ï¼Œä½†ä¸å¤ å…¨é¢", score: 2 },
                { text: "D. çŸ¥è­˜æœ‰é™ï¼Œéœ€è¦æ›´å¤šå­¸ç¿’", score: 1 }
            ], category: "knowledge" },
            {question: "æ‚¨å¦‚ä½•çœ‹å¾…æŠ•è³‡é¢¨éšªèˆ‡å›å ±çš„é—œä¿‚ï¼Ÿ âš–ï¸", options: [
                { text: "A. é¡˜æ„æ‰¿æ“”é«˜é¢¨éšªä»¥ç²å–é«˜å›å ±", score: 4 },
                { text: "B. åå¥½ä¸­ç­‰é¢¨éšªå’Œå›å ±çš„å¹³è¡¡", score: 3 },
                { text: "C. å‚¾å‘æ–¼ä½é¢¨éšªæŠ•è³‡ï¼Œå³ä½¿å›å ±è¼ƒä½", score: 2 },
                { text: "D. æ¥µåº¦å­æƒ¡é¢¨éšªï¼Œå®‰å…¨æ˜¯é¦–è¦è€ƒé‡", score: 1 }
            ], category: "risk_tolerance" },
            {question: "æ‚¨çš„ä¸»è¦æŠ•è³‡ç›®æ¨™æ˜¯ä»€éº¼ï¼Ÿ ğŸ¯", options: [
                { text: "A. è¿½æ±‚æœ€å¤§åŒ–è³‡æœ¬å¢å€¼ï¼Œé¡˜æ„æ‰¿æ“”æ³¢å‹•", score: 4 },
                { text: "B. è³‡æœ¬å¢å€¼èˆ‡æ”¶å…¥å¹³è¡¡", score: 3 },
                { text: "C. ä¿æœ¬ç‚ºä¸»ï¼Œé©åº¦å¢å€¼", score: 2 },
                { text: "D. ä¿æœ¬ä¿æ¯ï¼Œå®‰å…¨ç¬¬ä¸€", score: 1 }
            ], category: "goals" },
            {question: "æ‚¨è¨ˆåŠƒçš„æŠ•è³‡æ™‚é–“ç¯„åœæ˜¯å¤šä¹…ï¼Ÿ â±ï¸", options: [
                { text: "A. 10å¹´ä»¥ä¸Š", score: 4 },
                { text: "B. 5-10å¹´", score: 3 },
                { text: "C. 2-5å¹´", score: 2 },
                { text: "D. 2å¹´ä»¥ä¸‹", score: 1 }
            ], category: "planning" },
            {question: "æ‚¨å°è²¡å‹™è¦åŠƒçš„æ…‹åº¦æ˜¯ï¼Ÿ ğŸ“", options: [
                { text: "A. æœ‰è©³ç´°çš„é•·æœŸè²¡å‹™è¨ˆåŠƒä¸¦å®šæœŸæª¢è¦–", score: 4 },
                { text: "B. æœ‰åŸºæœ¬è¨ˆåŠƒï¼Œå¶çˆ¾æª¢è¦–", score: 3 },
                { text: "C. æœ‰ç°¡å–®æƒ³æ³•ï¼Œä½†æ²’æœ‰å…·é«”è¨ˆåŠƒ", score: 2 },
                { text: "D. å¾ˆå°‘è€ƒæ…®é•·æœŸè²¡å‹™è¦åŠƒ", score: 1 }
            ], category: "planning" },
            {question: "æ‚¨å¦‚ä½•çœ‹å¾…å¸‚å ´æ³¢å‹•ï¼Ÿ ğŸŒŠ", options: [
                { text: "A. äº†è§£å¸‚å ´é€±æœŸï¼Œè¦–ç‚ºæ­£å¸¸ç¾è±¡", score: 4 },
                { text: "B. æ¥å—æ³¢å‹•ï¼Œä½†æœƒé—œæ³¨è¶¨å‹¢è®ŠåŒ–", score: 3 },
                { text: "C. æœ‰äº›ä¸å®‰ï¼Œä½†èƒ½å¿å—çŸ­æœŸæ³¢å‹•", score: 2 },
                { text: "D. éå¸¸æ“”æ†‚ï¼Œåå¥½ç©©å®šæ€§", score: 1 }
            ], category: "market_knowledge" },
            {question: "æ‚¨åšæŠ•è³‡æ±ºç­–æ™‚ä¸»è¦ä¾æ“šä»€éº¼ï¼Ÿ ğŸ¤”", options: [
                { text: "A. è‡ªå·±çš„ç ”ç©¶å’Œåˆ†æ", score: 4 },
                { text: "B. çµåˆå°ˆæ¥­å»ºè­°å’Œè‡ªå·±åˆ¤æ–·", score: 3 },
                { text: "C. ä¸»è¦ä¾è³´å°ˆæ¥­é¡§å•å»ºè­°", score: 2 },
                { text: "D. è·Ÿéš¨è¦ªå‹æˆ–å¤§çœ¾æ„è¦‹", score: 1 }
            ], category: "decision_making" }
        ];
        const resultLevels = [
            {min:35,max:40,title:"å°ˆæ¥­æŠ•è³‡è€… ğŸ†",description:"æ‚¨å±•ç¾å‡ºå°ˆæ¥­ç´šçš„é‡‘èçŸ¥è­˜å’ŒæŠ•è³‡ç¶“é©—ã€‚æ‚¨äº†è§£å¸‚å ´é‹ä½œæ©Ÿåˆ¶ï¼Œèƒ½å¤ åˆ¶å®šè¤‡é›œçš„æŠ•è³‡ç­–ç•¥ï¼Œä¸¦åœ¨ä¸åŒå¸‚å ´ç’°å¢ƒä¸­åšå‡ºæ˜æ™ºæ±ºç­–ã€‚",icons:"ğŸ† ğŸ’° ğŸ“ˆ ğŸŒŸ ğŸš€",personality:"ç©æ¥µé€²å–å‹æŠ•è³‡è€…",traits:[
                {text:"é«˜é¢¨éšªæ‰¿å—åŠ›",color:"bg-red-100 text-red-800"}, {text:"é•·æœŸæŠ•è³‡è¦–é‡",color:"bg-blue-100 text-blue-800"}, {text:"å¸‚å ´æ´å¯ŸåŠ›å¼·",color:"bg-purple-100 text-purple-800"}, {text:"æ±ºç­–æœæ–·",color:"bg-orange-100 text-orange-800"}, {text:"è‡ªä¿¡ç¨ç«‹",color:"bg-green-100 text-green-800"}
            ],recommendations:[
                {title:"å¤šå…ƒåŒ–é«˜æˆé•·æŠ•è³‡çµ„åˆ",description:"é…ç½®70%æˆé•·å‹è³‡ç”¢ï¼ˆè‚¡ç¥¨ã€ETFï¼‰ã€20%å¦é¡æŠ•è³‡ï¼ˆREITsã€å•†å“ï¼‰ã€10%å›ºå®šæ”¶ç›Š",icon:"ğŸ“ˆ",tools:["å½­åšçµ‚ç«¯æ©Ÿ","å°ˆæ¥­åˆ¸å•†å¹³å°","æŠ•è³‡çµ„åˆç®¡ç†è»Ÿé«”","è²¡å ±åˆ†æå·¥å…·"]},
                {title:"ä¸»å‹•å‹æŠ•è³‡ç­–ç•¥",description:"åˆ©ç”¨æ‚¨çš„å°ˆæ¥­çŸ¥è­˜ï¼Œæ¡ç”¨åƒ¹å€¼æŠ•è³‡æˆ–æˆé•·æŠ•è³‡ç­–ç•¥ï¼Œå®šæœŸèª¿æ•´æŠ•è³‡çµ„åˆ",icon:"ğŸ”",tools:["æŠ€è¡“åˆ†æè»Ÿé«”","è²¡å‹™æ¨¡å‹å·¥å…·","å¸‚å ´æ•¸æ“šè¨‚é–±æœå‹™","å°ˆæ¥­æŠ•è³‡ç¤¾ç¾¤"]},
                {title:"ç¨…å‹™å„ªåŒ–ç­–ç•¥",description:"è€ƒæ…®åˆ©ç”¨ç¨…å‹™å„ªæƒ æŠ•è³‡å·¥å…·ï¼Œå¦‚é€€ä¼‘å¸³æˆ¶ã€ç‰¹å®šæŠ•è³‡è¨ˆåŠƒç­‰",icon:"ğŸ’¼",tools:["ç¨…å‹™è¦åŠƒè»Ÿé«”","å°ˆæ¥­æœƒè¨ˆé¡§å•","è·¨åœ‹è³‡ç”¢é…ç½®å¹³å°","ç¨…å‹™å„ªåŒ–è¨ˆç®—å™¨"]}
            ]},
            {min:28,max:34,title:"é€²éšæŠ•è³‡è€… ğŸŒŸ",description:"æ‚¨å…·æœ‰è±å¯Œçš„æŠ•è³‡çŸ¥è­˜å’Œç¶“é©—ã€‚æ‚¨äº†è§£å¤šç¨®æŠ•è³‡å·¥å…·ï¼Œèƒ½å¤ åˆ¶å®šåˆç†çš„æŠ•è³‡ç­–ç•¥ï¼Œä¸¦åœ¨å¸‚å ´æ³¢å‹•æ™‚ä¿æŒå†·éœã€‚",icons:"ğŸŒŸ ğŸ’¼ ğŸ“Š ğŸ’¡ ğŸ”",personality:"å‡è¡¡æˆé•·å‹æŠ•è³‡è€…",traits:[
                {text:"ä¸­é«˜é¢¨éšªæ‰¿å—åŠ›",color:"bg-orange-100 text-orange-800"}, {text:"ç†æ€§åˆ†æ",color:"bg-blue-100 text-blue-800"}, {text:"é©æ‡‰æ€§å¼·",color:"bg-teal-100 text-teal-800"}, {text:"ç©©å¥é€²å–",color:"bg-indigo-100 text-indigo-800"}
            ],recommendations:[
                {title:"å‡è¡¡æˆé•·æŠ•è³‡çµ„åˆ",description:"é…ç½®60%æˆé•·å‹è³‡ç”¢ã€30%å›ºå®šæ”¶ç›Šè³‡ç”¢ã€10%ç¾é‡‘æˆ–ç­‰åƒ¹ç‰©",icon:"âš–ï¸",tools:["æ™ºèƒ½æŠ•è³‡å¹³å°","ETFç¯©é¸å·¥å…·","è³‡ç”¢é…ç½®è¨ˆç®—å™¨","æŠ•è³‡çµ„åˆè¿½è¹¤App"]},
                {title:"å®šæœŸå†å¹³è¡¡ç­–ç•¥",description:"æ¯å­£æª¢è¦–æŠ•è³‡çµ„åˆï¼Œæ ¹æ“šå¸‚å ´è®ŠåŒ–å’Œå€‹äººç›®æ¨™é€²è¡Œèª¿æ•´",icon:"ğŸ”„",tools:["æŠ•è³‡çµ„åˆåˆ†æå·¥å…·","å†å¹³è¡¡æé†’æœå‹™","å¸‚å ´è¶¨å‹¢è¿½è¹¤App","é¢¨éšªè©•ä¼°å·¥å…·"]},
                {title:"ç³»çµ±æ€§æŠ•è³‡è¨ˆåŠƒ",description:"å»ºç«‹è‡ªå‹•åŒ–æŠ•è³‡ç³»çµ±ï¼Œæ¸›å°‘æƒ…ç·’åŒ–æ±ºç­–çš„å½±éŸ¿",icon:"â±ï¸",tools:["è‡ªå‹•åŒ–æŠ•è³‡å¹³å°","å®šæœŸå®šé¡æŠ•è³‡æœå‹™","æŠ•è³‡æ—¥æ›†å·¥å…·","ç›®æ¨™è¿½è¹¤App"]}
            ]},
            {min:20,max:27,title:"ä¸­ç´šæŠ•è³‡è€… ğŸ’¡",description:"æ‚¨å…·å‚™åŸºæœ¬çš„é‡‘èçŸ¥è­˜ï¼Œä¸¦æœ‰ä¸€å®šçš„æŠ•è³‡ç¶“é©—ã€‚æ‚¨äº†è§£åŸºæœ¬çš„æŠ•è³‡æ¦‚å¿µï¼Œä½†å¯èƒ½éœ€è¦åœ¨æŸäº›é ˜åŸŸæ·±å…¥å­¸ç¿’ã€‚",icons:"ğŸ’¡ ğŸ“š ğŸ“ ğŸ” ğŸ“Š",personality:"ç©©å¥æˆé•·å‹æŠ•è³‡è€…",traits:[
                {text:"ä¸­ç­‰é¢¨éšªæ‰¿å—åŠ›",color:"bg-yellow-100 text-yellow-800"}, {text:"è¬¹æ…æ±ºç­–",color:"bg-blue-100 text-blue-800"}, {text:"å­¸ç¿’æ„é¡˜å¼·",color:"bg-green-100 text-green-800"}, {text:"å°‹æ±‚å¹³è¡¡",color:"bg-purple-100 text-purple-800"}
            ],recommendations:[
                {title:"ç©©å¥æˆé•·æŠ•è³‡çµ„åˆ",description:"é…ç½®50%æˆé•·å‹è³‡ç”¢ã€40%å›ºå®šæ”¶ç›Šè³‡ç”¢ã€10%ç¾é‡‘æˆ–ç­‰åƒ¹ç‰©",icon:"ğŸŒ±",tools:["åŸºé‡‘ç¯©é¸å¹³å°","æŒ‡æ•¸ETFè¿½è¹¤å·¥å…·","é¢¨éšªè©•ä¼°å•å·","åŸºæœ¬æŠ•è³‡çµ„åˆæ¨¡æ¿"]},
                {title:"æŒ‡æ•¸æŠ•è³‡ç­–ç•¥",description:"è€ƒæ…®ä½¿ç”¨æŒ‡æ•¸åŸºé‡‘æˆ–ETFé€²è¡Œä½æˆæœ¬ã€åˆ†æ•£åŒ–æŠ•è³‡",icon:"ğŸ“Š",tools:["ä½æˆæœ¬æŒ‡æ•¸åŸºé‡‘å¹³å°","ETFæ¯”è¼ƒå·¥å…·","è¢«å‹•æŠ•è³‡æŒ‡å—","è²»ç”¨æ¯”è¼ƒè¨ˆç®—å™¨"]},
                {title:"æŒçºŒå­¸ç¿’è¨ˆåŠƒ",description:"åƒåŠ æŠ•è³‡èª²ç¨‹æˆ–ç ”è¨æœƒï¼Œæå‡é‡‘èçŸ¥è­˜å’ŒæŠ•è³‡æŠ€èƒ½",icon:"ğŸ“š",tools:["æŠ•è³‡å­¸ç¿’App","é‡‘èçŸ¥è­˜ç¶²ç«™è¨‚é–±","æŠ•è³‡æ›¸ç±æ¨è–¦æ¸…å–®","ç·šä¸Šèª²ç¨‹å¹³å°"]}
            ]},
            {min:10,max:19,title:"åˆç´šæŠ•è³‡è€… ğŸŒ±",description:"æ‚¨æ­£åœ¨é–‹å§‹æ‚¨çš„æŠ•è³‡æ—…ç¨‹ã€‚æ‚¨å°é‡‘èå¸‚å ´æœ‰åŸºæœ¬äº†è§£ï¼Œä½†éœ€è¦æ›´å¤šå­¸ç¿’å’Œç¶“é©—ä¾†å»ºç«‹ä¿¡å¿ƒã€‚",icons:"ğŸŒ± ğŸ”° ğŸ“˜ ğŸ§© ğŸ”",personality:"ä¿å®ˆç©©å¥å‹æŠ•è³‡è€…",traits:[
                {text:"ä½é¢¨éšªæ‰¿å—åŠ›",color:"bg-green-100 text-green-800"}, {text:"ä¿å®ˆè¬¹æ…",color:"bg-blue-100 text-blue-800"}, {text:"å®‰å…¨å°å‘",color:"bg-teal-100 text-teal-800"}, {text:"åˆå­¸æˆé•·ä¸­",color:"bg-yellow-100 text-yellow-800"}
            ],recommendations:[
                {title:"ä¿å®ˆç©©å¥æŠ•è³‡çµ„åˆ",description:"é…ç½®30%æˆé•·å‹è³‡ç”¢ã€50%å›ºå®šæ”¶ç›Šè³‡ç”¢ã€20%ç¾é‡‘æˆ–ç­‰åƒ¹ç‰©",icon:"ğŸ›¡ï¸",tools:["å…¥é–€æŠ•è³‡App","ä¿å®ˆå‹åŸºé‡‘ç¯©é¸å™¨","å„²è“„è¨ˆç®—å·¥å…·","é¢¨éšªè©•ä¼°å•å·"]},
                {title:"å®šé¡å®šæœŸæŠ•è³‡",description:"æ¡ç”¨å®šé¡å®šæœŸæŠ•è³‡ç­–ç•¥ï¼Œé™ä½å¸‚å ´æ³¢å‹•é¢¨éšª",icon:"ğŸ“…",tools:["è‡ªå‹•å„²è“„App","å®šæœŸå®šé¡æŠ•è³‡å¹³å°","å°é¡æŠ•è³‡å·¥å…·","æŠ•è³‡ç¿’æ…£è¿½è¹¤å™¨"]},
                {title:"åŸºç¤é‡‘èæ•™è‚²",description:"é–±è®€æŠ•è³‡å…¥é–€æ›¸ç±ï¼ŒåƒåŠ åŸºç¤ç†è²¡èª²ç¨‹ï¼Œå»ºç«‹ç©©å›ºçš„é‡‘èçŸ¥è­˜åŸºç¤",icon:"ğŸ“–",tools:["é‡‘èå…¥é–€App","åŸºç¤ç†è²¡èª²ç¨‹","æŠ•è³‡è©å½™è¡¨","ç†è²¡ç¤¾ç¾¤å¹³å°"]}
            ]}
        ];

        // ==== ç‹€æ…‹è®Šæ•¸ ====
        let currentQuestion = 0;
        let totalScore = 0;
        let userAnswers = [];
        let categoryScores = {
            experience: 0, knowledge: 0, risk_tolerance: 0, goals: 0, planning: 0, market_knowledge: 0, decision_making: 0
        };
        let userInfo = { name: "", age: "", occupation: "", email: "", region: "" };

        // ==== DOM ====
        const userInfoForm = document.getElementById('user-info-form');
        const questionScreen = document.getElementById('question-screen');
        const resultScreen = document.getElementById('result-screen');
        const nextBtn = document.getElementById('next-btn');
        const prevBtn = document.getElementById('prev-btn');
        const progressBar = document.getElementById('progress-bar');
        const questionNumber = document.getElementById('question-number');
        const questionText = document.getElementById('question-text');
        const optionsContainer = document.getElementById('options-container');
        createFloatingElements();

        userInfoForm.addEventListener('submit', (e) => {
            e.preventDefault();
            userInfo.name = document.getElementById('name').value.trim();
            userInfo.age = document.getElementById('age').value.trim();
            userInfo.occupation = document.getElementById('occupation').value.trim();
            userInfo.email = document.getElementById('email').value.trim();
            userInfo.region = document.getElementById('region').value;
            if (!userInfo.name || !userInfo.age || !userInfo.occupation || !userInfo.region || !userInfo.email) {
                showToast('è«‹å¡«å¯«æ‰€æœ‰å¿…å¡«æ¬„ä½');
                return;
            }
            userInfoForm.classList.add('hidden');
            questionScreen.classList.remove('hidden');
            showQuestion();
        });

        function showQuestion() {
            const question = questions[currentQuestion];
            questionNumber.textContent = `å•é¡Œ ${currentQuestion + 1}/${questions.length}`;
            questionText.textContent = question.question;
            progressBar.style.width = `${((currentQuestion) / questions.length) * 100}%`;
            optionsContainer.innerHTML = '';
            nextBtn.disabled = userAnswers[currentQuestion] === undefined;
            question.options.forEach((option, idx) => {
                const btn = document.createElement('button');
                btn.type = "button";
                btn.className = "btn-option w-full text-left p-4 rounded-lg border-2 transition-all mb-2" +
                    (userAnswers[currentQuestion] === idx ? " selected border-teal-500 bg-teal-50" : " border-gray-200 hover:border-teal-300");
                btn.innerHTML = option.text;
                btn.tabIndex = 0;
                btn.addEventListener('click', () => {
                    selectOption(idx);
                    nextBtn.disabled = false;
                });
                optionsContainer.appendChild(btn);
            });
            prevBtn.classList.toggle('hidden', currentQuestion === 0);
            nextBtn.textContent = currentQuestion === questions.length - 1 ? 'å®Œæˆæ¸¬é©— âœ…' : 'ä¸‹ä¸€é¡Œ â–¶ï¸';
        }

        function selectOption(idx) {
            const question = questions[currentQuestion];
            const previous = userAnswers[currentQuestion];
            userAnswers[currentQuestion] = idx;
            if (previous !== undefined) {
                totalScore -= question.options[previous].score;
                if (question.category) categoryScores[question.category] -= question.options[previous].score;
            }
            totalScore += question.options[idx].score;
            if (question.category) categoryScores[question.category] += question.options[idx].score;
            Array.from(optionsContainer.children).forEach((btn, i) => {
                btn.className = "btn-option w-full text-left p-4 rounded-lg border-2 transition-all mb-2" +
                    (i === idx ? " selected border-teal-500 bg-teal-50" : " border-gray-200 hover:border-teal-300");
            });
        }

        nextBtn.addEventListener('click', () => {
            if (userAnswers[currentQuestion] === undefined) {
                showToast('è«‹é¸æ“‡ä¸€å€‹é¸é …å†ç¹¼çºŒ');
                return;
            }
            if (currentQuestion < questions.length - 1) {
                currentQuestion++;
                showQuestion();
            } else {
                showResult();
            }
        });
        prevBtn.addEventListener('click', () => {
            if (currentQuestion > 0) {
                currentQuestion--;
                showQuestion();
            }
        });

        // ==== Google Sheets å‚³é€ ====
        function sendToGoogleSheets(data) {
            fetch(GOOGLE_SCRIPT_URL, {
                method: 'POST',
                mode: 'no-cors',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(data)
            })
            .then(() => showToast("è³‡æ–™å·²é€å‡ºï¼"))
            .catch(() => showToast("è³‡æ–™é€å‡ºå¤±æ•—"));
        }

        // ==== çµæœé¡¯ç¤º ====
        function showResult() {
            questionScreen.classList.add('hidden');
            resultScreen.classList.remove('hidden');
            progressBar.style.width = '100%';
            let resultLevel = resultLevels[resultLevels.length - 1];
            for (const level of resultLevels) {
                if (totalScore >= level.min && totalScore <= level.max) {
                    resultLevel = level; break;
                }
            }
            const answerDetails = questions.map((q, idx) => ({
                question: q.question,
                answer: q.options[userAnswers[idx]]?.text || "",
                score: q.options[userAnswers[idx]]?.score || 0
            }));
            // å‚³é€åˆ° Google Sheets
            sendToGoogleSheets({
                name: userInfo.name,
                age: userInfo.age,
                occupation: userInfo.occupation,
                email: userInfo.email,
                region: userInfo.region,                
                totalScore,
                resultTitle: resultLevel.title,
                resultDescription: resultLevel.description,
                personality: resultLevel.personality,
                answers: answerDetails,
                timestamp: new Date().toISOString()
            });
            // çµæœ UI
            resultScreen.innerHTML = `
                <h2 class="text-2xl font-bold text-center text-teal-700 mb-4">${userInfo.name} çš„è²¡å‹™åˆ†æçµæœ</h2>
                <div class="text-center mb-6">
                    <div class="text-3xl mb-4">${resultLevel.icons.split(' ').map(icon=>`<span class="celebration">${icon}</span>`).join('')}</div>
                    <p class="text-lg text-gray-700">${resultLevel.description}</p>
                </div>
                <div class="bg-gray-50 p-4 rounded-lg mb-6">
                    <h3 class="font-bold text-gray-700 mb-2">å€‹äººè³‡è¨Š</h3>
                    <div class="grid grid-cols-2 gap-2 text-sm">
                        <div><span class="text-gray-500">å¹´é½¡ï¼š</span><span class="font-medium">${userInfo.age}</span></div>
                        <div><span class="text-gray-500">è·æ¥­ï¼š</span><span class="font-medium">${userInfo.occupation}</span></div>
                        <div><span class="text-gray-500">EMAILï¼š</span><span class="font-medium">${userInfo.email}</span></div>
                        <div><span class="text-gray-500">å±…ä½åœ°å€ï¼š</span><span class="font-medium">${userInfo.region}</span></div>
                    </div>
                </div>
                <div class="bg-blue-50 border-l-4 border-blue-500 p-4 mb-6">
                    <h3 class="font-bold text-blue-700 mb-2">æ‚¨çš„æŠ•è³‡äººæ ¼ç‰¹è³ª</h3>
                    <p class="text-blue-600 mb-3">${resultLevel.personality}</p>
                    <div>${resultLevel.traits.map(trait=>`<span class="trait-badge ${trait.color}">${trait.text}</span>`).join('')}</div>
                </div>
                <div class="mb-6">
                    <h3 class="font-bold text-teal-700 mb-3">æ‚¨çš„æŠ•è³‡å±¬æ€§åˆ†æ</h3>
                    <div class="chart-container" style="position:relative;height:250px;width:100%;max-width:500px;margin:0 auto;">
                        <canvas id="attributes-chart"></canvas>
                    </div>
                </div>
                <div class="mb-6">
                    <h3 class="font-bold text-teal-700 mb-3">å°ˆå±¬ç†è²¡å»ºè­°</h3>
                    <div>
                    ${resultLevel.recommendations.map(rec=>`
                        <div class="recommendation-card bg-white p-4 rounded-lg shadow-md border-l-4 border-teal-500 mb-4">
                            <div class="flex items-start">
                                <span class="text-3xl mr-3">${rec.icon}</span>
                                <div class="flex-1">
                                    <h4 class="font-bold text-teal-700">${rec.title}</h4>
                                    <p class="text-gray-600">${rec.description}</p>
                                    <div class="mt-2 pt-2 border-t border-gray-100">
                                        <p class="text-xs text-teal-700 font-medium mb-1">å»ºè­°å·¥å…·ï¼š</p>
                                        <div class="flex flex-wrap">${rec.tools.map(tool=>`<span class="tool-tag">${tool}</span>`).join('')}</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `).join('')}
                    </div>
                </div>
                <button id="restart-btn" class="w-full bg-gradient-to-r from-teal-500 to-blue-500 text-white font-medium py-3 px-8 rounded-full">é‡æ–°æ¸¬é©— ğŸ”„</button>
            `;
            setTimeout(createAttributesChart, 200);
            document.getElementById('restart-btn').addEventListener('click', restartQuiz);
        }

        function createAttributesChart() {
            const ctx = document.getElementById('attributes-chart');
            if (!ctx) return;
            const experienceP = (categoryScores.experience / 4) * 100;
            const knowledgeP = ((categoryScores.knowledge + categoryScores.market_knowledge) / 8) * 100;
            const riskToleranceP = (categoryScores.risk_tolerance / 8) * 100;
            const planningP = ((categoryScores.planning + categoryScores.goals) / 8) * 100;
            const decisionMakingP = (categoryScores.decision_making / 4) * 100;
            new Chart(ctx, {
                type: 'radar',
                data: {
                    labels: ['æŠ•è³‡ç¶“é©— ğŸ“ˆ', 'é‡‘èçŸ¥è­˜ ğŸ“š', 'é¢¨éšªæ‰¿å—åŠ› âš–ï¸', 'è²¡å‹™è¦åŠƒ ğŸ“', 'æ±ºç­–èƒ½åŠ› ğŸ¤”'],
                    datasets: [{
                        label: 'æ‚¨çš„æŠ•è³‡å±¬æ€§',
                        data: [experienceP, knowledgeP, riskToleranceP, planningP, decisionMakingP],
                        backgroundColor: 'rgba(72, 187, 120, 0.2)',
                        borderColor: 'rgba(72, 187, 120, 1)',
                        pointBackgroundColor: 'rgba(72, 187, 120, 1)',
                        pointBorderColor: '#fff',
                        pointHoverBackgroundColor: '#fff',
                        pointHoverBorderColor: 'rgba(72, 187, 120, 1)'
                    }]
                },
                options: {
                    scales: {
                        r: { angleLines: { display: true }, suggestedMin: 0, suggestedMax: 100, ticks: { display: false } }
                    },
                    plugins: { legend: { display: false } }
                }
            });
        }

        function restartQuiz() {
            currentQuestion = 0;
            totalScore = 0;
            userAnswers = [];
            categoryScores = {experience:0,knowledge:0,risk_tolerance:0,goals:0,planning:0,market_knowledge:0,decision_making:0};
            userInfo = { name: "", age: "", occupation: "", email: "", region: "" };
            resultScreen.classList.add('hidden');
            userInfoForm.reset();
            userInfoForm.classList.remove('hidden');
            progressBar.style.width = '0%';
        }

        function createFloatingElements() {
            const floatingElements = document.getElementById('floating-elements');
            const emojis = ['ğŸ”¬', 'ğŸ¦ ', 'ğŸ§«', 'ğŸ§ª', 'ğŸ§¬'];
            const count = 15;
            for (let i = 0; i < count; i++) {
                const element = document.createElement('div');
                element.className = 'floating';
                element.textContent = emojis[Math.floor(Math.random() * emojis.length)];
                element.style.fontSize = `${(Math.random() * 3 + 2).toFixed(2)}rem`;
                element.style.left = `${(Math.random() * 100).toFixed(2)}%`;
                element.style.top = `${(Math.random() * 100).toFixed(2)}%`;
                element.style.animationDelay = `${(Math.random() * 5).toFixed(2)}s`;
                element.style.animationDuration = `${(Math.random() * 5 + 5).toFixed(2)}s`;
                floatingElements.appendChild(element);
            }
        }

        function showToast(msg) {
            let toast = document.getElementById('toast');
            if (!toast) {
                toast = document.createElement('div');
                toast.id = 'toast';
                toast.style.position = 'fixed';
                toast.style.bottom = '32px';
                toast.style.left = '50%';
                toast.style.transform = 'translateX(-50%)';
                toast.style.background = 'rgba(16,115,115,.95)';
                toast.style.color = 'white';
                toast.style.padding = '12px 24px';
                toast.style.borderRadius = '999px';
                toast.style.fontSize = '16px';
                toast.style.boxShadow = '0 6px 24px rgba(0,0,0,.18)';
                toast.style.zIndex = 9999;
                document.body.appendChild(toast);
            }
            toast.textContent = msg;
            toast.style.display = 'block';
            setTimeout(() => { toast.style.display = 'none'; }, 1800);
        }
    </script>
</body>
</html>
